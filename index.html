<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
<style>
body {
    font-size: 160px;
    text-align: center;
}
</style>
</head>
<body>

<div id="emoji">ðŸŽ±</div>
<div id="countdown"></div>

<script>
var countdown = document.getElementById('countdown');
var emoji = document.getElementById('emoji');

var attrs = {
    'months': 'getMonths',
    'days': 'getDate',
    'hours': 'getHours',
    'minutes': 'getMinutes',
    'seconds': 'getSeconds',
}


var search = window.location.search;
var query = {};
search.substring(1, search.length).split('&').forEach(function(pair) {
    pair = pair.split('=');
    query[pair[0]] = pair[1];
})

var data = {
    emoji: decodeURIComponent(query.e) || 'ðŸŽ±',
    time: {
        hours: 16,
        minutes: 35,
        seconds: 59,
    },
};

emoji.innerHTML = data.emoji;
document.title = data.emoji;

if (query.time) {
    var time = query.time.split(':');
    data.time.hours = time[0];
    data.time.minutes = time[1];
    if (time.length > 2) {
        data.time.seconds = times[2];
    }
}

if (query.date) {
    var date = query.date.split('-').reverse();
    data.time.days = date[0];
    date.length > 1 && (data.time.month = date[1])
    date.length > 2 && (data.time.month = date[2])
}

function timeUntil() {
    var now = new Date();
    var until = {
    };
    for (var key in attrs) {
        var method = attrs[key];
        if (data.time[key]) {
            until[key] = data.time[key] - now[method]();
        }
    }
    return until;
}

function format(until) {
    var times = ['months', 'days', 'hours', 'minutes', 'seconds'].filter(function(unit) {
        return until[unit] !== undefined && until[unit] > 0;
    }).map(function(unit) {
        return until[unit] + ' ' + unit;
    });
    return times;
}

function append() {
    var until = timeUntil();
    countdown.innerHTML = format(until).join(' ');
}

window.setInterval(append, 1000);

append();
</script>

</body>
</html>
